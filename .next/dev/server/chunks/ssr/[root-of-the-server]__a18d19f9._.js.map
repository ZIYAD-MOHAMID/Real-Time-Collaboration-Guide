{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\";\r\nimport { twMerge } from \"tailwind-merge\";\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/components/ui/Button.tsx"],"sourcesContent":["import { forwardRef } from 'react'\r\nimport { cn } from '@/lib/utils'\r\n\r\nexport interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\r\n  variant?: 'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link'\r\n  size?: 'default' | 'sm' | 'lg' | 'icon'\r\n  asChild?: boolean\r\n}\r\n\r\nconst Button = forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, variant = 'default', size = 'default', asChild = false, ...props }, ref) => {\r\n    return (\r\n      <button\r\n        className={cn(\r\n          'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',\r\n          {\r\n            'bg-primary text-primary-foreground hover:bg-primary/90': variant === 'default',\r\n            'bg-destructive text-destructive-foreground hover:bg-destructive/90': variant === 'destructive',\r\n            'border border-input bg-background hover:bg-accent hover:text-accent-foreground': variant === 'outline',\r\n            'bg-secondary text-secondary-foreground hover:bg-secondary/80': variant === 'secondary',\r\n            'hover:bg-accent hover:text-accent-foreground': variant === 'ghost',\r\n            'text-primary underline-offset-4 hover:underline': variant === 'link',\r\n          },\r\n          {\r\n            'h-10 px-4 py-2': size === 'default',\r\n            'h-9 rounded-md px-3': size === 'sm',\r\n            'h-11 rounded-md px-8': size === 'lg',\r\n            'h-10 w-10': size === 'icon',\r\n          },\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nButton.displayName = 'Button'\r\n\r\nexport { Button }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAQA,MAAM,uBAAS,IAAA,mNAAU,EACvB,CAAC,EAAE,SAAS,EAAE,UAAU,SAAS,EAAE,OAAO,SAAS,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IAChF,qBACE,8OAAC;QACC,WAAW,IAAA,yHAAE,EACX,0RACA;YACE,0DAA0D,YAAY;YACtE,sEAAsE,YAAY;YAClF,kFAAkF,YAAY;YAC9F,gEAAgE,YAAY;YAC5E,gDAAgD,YAAY;YAC5D,mDAAmD,YAAY;QACjE,GACA;YACE,kBAAkB,SAAS;YAC3B,uBAAuB,SAAS;YAChC,wBAAwB,SAAS;YACjC,aAAa,SAAS;QACxB,GACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/components/ui/Input.tsx"],"sourcesContent":["import { forwardRef } from 'react'\r\nimport { cn } from '@/lib/utils'\r\n\r\nexport interface InputProps\r\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\r\n\r\nconst Input = forwardRef<HTMLInputElement, InputProps>(\r\n  ({ className, type, ...props }, ref) => {\r\n    return (\r\n      <input\r\n        type={type}\r\n        className={cn(\r\n          'flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nInput.displayName = 'Input'\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAKA,MAAM,sBAAQ,IAAA,mNAAU,EACtB,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,8OAAC;QACC,MAAM;QACN,WAAW,IAAA,yHAAE,EACX,gWACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/components/ui/Card.tsx"],"sourcesContent":["import { forwardRef } from 'react'\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst Card = forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\r\n      'rounded-lg border bg-card text-card-foreground shadow-sm',\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nCard.displayName = 'Card'\r\n\r\nconst CardHeader = forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn('flex flex-col space-y-1.5 p-6', className)}\r\n    {...props}\r\n  />\r\n))\r\nCardHeader.displayName = 'CardHeader'\r\n\r\nconst CardTitle = forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h3\r\n    ref={ref}\r\n    className={cn(\r\n      'text-2xl font-semibold leading-none tracking-tight',\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nCardTitle.displayName = 'CardTitle'\r\n\r\nconst CardDescription = forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <p\r\n    ref={ref}\r\n    className={cn('text-sm text-muted-foreground', className)}\r\n    {...props}\r\n  />\r\n))\r\nCardDescription.displayName = 'CardDescription'\r\n\r\nconst CardContent = forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div ref={ref} className={cn('p-6 pt-0', className)} {...props} />\r\n))\r\nCardContent.displayName = 'CardContent'\r\n\r\nconst CardFooter = forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn('flex items-center p-6 pt-0', className)}\r\n    {...props}\r\n  />\r\n))\r\nCardFooter.displayName = 'CardFooter'\r\n\r\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AACA;;;;AAEA,MAAM,qBAAO,IAAA,mNAAU,EAGrB,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EACX,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,IAAA,mNAAU,EAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,IAAA,mNAAU,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,IAAA,mNAAU,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,IAAA,mNAAU,EAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,IAAA,yHAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,IAAA,mNAAU,EAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/components/ShareDialog.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { ApolloClient, InMemoryCache, HttpLink } from \"@apollo/client\";\r\nimport { useMutation, useQuery } from \"@apollo/client/react\";\r\nimport { gql } from \"@apollo/client/core\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/Card\";\r\n\r\nconst SHARE_DOCUMENT_MUTATION = gql`\r\n  mutation ShareDocument(\r\n    $documentId: String!\r\n    $userId: String!\r\n    $permission: PermissionType!\r\n  ) {\r\n    shareDocument(\r\n      documentId: $documentId\r\n      userId: $userId\r\n      permission: $permission\r\n    ) {\r\n      id\r\n      user {\r\n        id\r\n        name\r\n        email\r\n      }\r\n      permission\r\n    }\r\n  }\r\n`;\r\nconst GET_DOCUMENT_ACCESS_QUERY = gql`\r\n  query GetDocumentAccess($documentId: String!) {\r\n    document(id: $documentId) {\r\n      id\r\n      access {\r\n        id\r\n        permission\r\n        user {\r\n          id\r\n          name\r\n          email\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\nconst REMOVE_ACCESS_MUTATION = gql`\r\n  mutation RemoveAccess($documentId: String!, $userId: String!) {\r\n    revokeAccess(documentId: $documentId, userId: $userId)\r\n  }\r\n`;\r\ninterface User {\r\n  id: string;\r\n  name?: string;\r\n  email: string;\r\n}\r\n\r\ninterface ShareDocumentResponse {\r\n  id: string;\r\n  user: User;\r\n  permission: \"VIEWER\" | \"EDITOR\" | \"ADMIN\";\r\n}\r\n\r\ninterface ShareDocumentData {\r\n  shareDocument: ShareDocumentResponse;\r\n}\r\n\r\ninterface ShareDialogProps {\r\n  documentId: string;\r\n  documentTitle: string;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onShareComplete?: () => void; // Callback to refresh document list\r\n}\r\n\r\nexport function ShareDialog({\r\n  documentId,\r\n  documentTitle,\r\n  isOpen,\r\n  onClose,\r\n  onShareComplete,\r\n}: ShareDialogProps) {\r\n  const { data: session } = useSession();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [permission, setPermission] = useState<\"VIEWER\" | \"EDITOR\" | \"ADMIN\">(\r\n    \"EDITOR\"\r\n  );\r\n  const [shareResults, setShareResults] = useState<ShareDocumentResponse[]>([]);\r\n  const [isSharing, setIsSharing] = useState(false);\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState(\"\");\r\n\r\n  // Reset share results when document changes\r\n  React.useEffect(() => {\r\n    if (isOpen) {\r\n      // setShareResults([])\r\n      setEmail(\"\");\r\n      setPermission(\"EDITOR\");\r\n      setShowSuccess(false);\r\n      setSuccessMessage(\"\");\r\n    }\r\n  }, [documentId, isOpen]);\r\n\r\n  const client = React.useMemo(\r\n    () =>\r\n      new ApolloClient({\r\n        link: new HttpLink({\r\n          uri: \"/api/graphql\",\r\n          credentials: \"include\",\r\n          headers: {\r\n            ...(session && {\r\n              \"x-user-id\": session.user?.id || \"\",\r\n            }),\r\n          },\r\n        }),\r\n        cache: new InMemoryCache(),\r\n      }),\r\n    [session?.user?.id]\r\n  );\r\n  const { data: accessData, loading: loadingAccess } = useQuery<{\r\n    document: { access: ShareDocumentResponse[] };\r\n  }>(GET_DOCUMENT_ACCESS_QUERY, {\r\n    variables: { documentId },\r\n    skip: !isOpen || !documentId, // Skip query if dialog is closed or no ID\r\n    fetchPolicy: \"network-only\", // Always get the latest data\r\n    client,\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (accessData?.document?.access) {\r\n      setShareResults(accessData.document.access);\r\n    }\r\n  }, [accessData]);\r\n\r\n  const [shareDocument] = useMutation<ShareDocumentData>(\r\n    SHARE_DOCUMENT_MUTATION,\r\n    { client }\r\n  );\r\n  const [removeAccess] = useMutation(REMOVE_ACCESS_MUTATION, { client });\r\n\r\n  const handleShare = async () => {\r\n    if (!email.trim()) return;\r\n\r\n    // 1. Check if the user is already in the list (case-insensitive email check)\r\n    const existingAccess = shareResults.find(\r\n      (result) => result.user.email.toLowerCase() === email.trim().toLowerCase()\r\n    );\r\n\r\n    // If the user already exists, we must stop and prompt the user to update their permission instead.\r\n    if (existingAccess) {\r\n      // Option A: If they are already on the target permission, just show success and return.\r\n      if (existingAccess.permission === permission) {\r\n        setSuccessMessage(`${email} already has ${permission} access.`);\r\n        setShowSuccess(true);\r\n        setTimeout(() => setShowSuccess(false), 3000);\r\n        return;\r\n      }\r\n\r\n      // Option B: User is already shared, but with a different permission.\r\n      // Show an error/suggestion to the user.\r\n      setSuccessMessage(\r\n        `Failed: ${email} already has ${existingAccess.permission} access. Use the list below to manage permissions.`\r\n      );\r\n      setShowSuccess(true);\r\n      setTimeout(() => setShowSuccess(false), 5000);\r\n      return; // Stop the function here\r\n    }\r\n\r\n    // 2. Execute the mutation (User is new)\r\n    setIsSharing(true);\r\n    try {\r\n      const result = await shareDocument({\r\n        variables: {\r\n          documentId,\r\n          userId: email,\r\n          permission: permission as any,\r\n        },\r\n      });\r\n\r\n      if (result.data) {\r\n        // Success logic\r\n        setShareResults([...shareResults, result.data.shareDocument]);\r\n        setSuccessMessage(`Successfully shared with ${email}`);\r\n        setShowSuccess(true);\r\n        setEmail(\"\");\r\n\r\n        if (onShareComplete) {\r\n          onShareComplete();\r\n        }\r\n\r\n        setTimeout(() => setShowSuccess(false), 3000);\r\n      }\r\n    } catch (error) {\r\n      // Error logic\r\n      console.error(\"Error sharing document:\", error);\r\n      setSuccessMessage(`Failed to share with ${email}`);\r\n      setShowSuccess(true);\r\n      setTimeout(() => setShowSuccess(false), 3000);\r\n    } finally {\r\n      setIsSharing(false);\r\n    }\r\n  };\r\n\r\n  const handleRemoveAccess = async (userId: string) => {\r\n    console.log(userId);\r\n\r\n    try {\r\n      await removeAccess({\r\n        variables: {\r\n          documentId,\r\n          userId,\r\n        },\r\n      });\r\n      setShareResults(shareResults.filter((r) => r.user.id !== userId));\r\n      setSuccessMessage(\"Access removed successfully\");\r\n      setShowSuccess(true);\r\n\r\n      // Call refresh callback if provided\r\n      if (onShareComplete) {\r\n        onShareComplete();\r\n      }\r\n\r\n      setTimeout(() => setShowSuccess(false), 3000);\r\n    } catch (error: any) {\r\n      // Log the ENTIRE error object for detailed inspection\r\n      console.error(\"Error removing access:\", error);\r\n\r\n      // Log specific details often found in Apollo Client errors\r\n      if (error.graphQLErrors && error.graphQLErrors.length > 0) {\r\n        console.error(\"GraphQL Errors:\", error.graphQLErrors);\r\n        // If you see errors here, the server is confirming the failure (e.g., 'Permission Denied')\r\n        setSuccessMessage(\r\n          error.graphQLErrors[0].message ||\r\n            \"Failed to remove access (Permission Denied)\"\r\n        );\r\n      } else if (error.networkError) {\r\n        console.error(\"Network Error:\", error.networkError);\r\n        // If you see a network error here, the server is unreachable\r\n        setSuccessMessage(\"Failed to remove access (Network Error)\");\r\n      } else {\r\n        setSuccessMessage(\"Failed to remove access\");\r\n      }\r\n\r\n      setShowSuccess(true);\r\n      setTimeout(() => setShowSuccess(false), 3000);\r\n    }\r\n  };\r\n\r\n  const getPermissionColor = (perm: string) => {\r\n    switch (perm) {\r\n      case \"ADMIN\":\r\n        return \"bg-red-100 text-red-800 border-red-200\";\r\n      case \"EDITOR\":\r\n        return \"bg-blue-100 text-blue-800 border-blue-200\";\r\n      case \"VIEWER\":\r\n        return \"bg-green-100 text-green-800 border-green-200\";\r\n      default:\r\n        return \"bg-gray-100 text-gray-800 border-gray-200\";\r\n    }\r\n  };\r\n\r\n  const getPermissionIcon = (perm: string) => {\r\n    switch (perm) {\r\n      case \"ADMIN\":\r\n        return \"üëë\";\r\n      case \"EDITOR\":\r\n        return \"‚úèÔ∏è\";\r\n      case \"VIEWER\":\r\n        return \"üëÅ\";\r\n      default:\r\n        return \"üë§\";\r\n    }\r\n  };\r\n\r\n  const getPermissionDescription = (perm: string) => {\r\n    switch (perm) {\r\n      case \"ADMIN\":\r\n        return \"Full control - can manage permissions and delete\";\r\n      case \"EDITOR\":\r\n        return \"Can edit and share the document\";\r\n      case \"VIEWER\":\r\n        return \"Can only view the document\";\r\n      default:\r\n        return \"Unknown permission\";\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <Card className=\"w-full max-w-lg max-h-[85vh] overflow-y-auto shadow-2xl\">\r\n        <CardHeader className=\"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border-b\">\r\n          <CardTitle className=\"flex items-center gap-2 text-xl\">\r\n            <div className=\"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white font-bold\">\r\n              üì§\r\n            </div>\r\n            Share \"{documentTitle}\"\r\n          </CardTitle>\r\n          <CardDescription className=\"text-slate-600 dark:text-slate-300\">\r\n            Invite collaborators to work on this document\r\n          </CardDescription>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"space-y-6 p-6\">\r\n          {/* Success/Error Message */}\r\n          {showSuccess && (\r\n            <div\r\n              className={`p-3 rounded-lg border ${\r\n                successMessage.includes(\"Failed\")\r\n                  ? \"bg-red-50 border-red-200 text-red-700\"\r\n                  : \"bg-green-50 border-green-200 text-green-700\"\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-lg\">\r\n                  {successMessage.includes(\"Failed\") ? \"‚ùå\" : \"‚úÖ\"}\r\n                </span>\r\n                <span className=\"text-sm font-medium\">{successMessage}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Share Form */}\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label\r\n                htmlFor=\"email\"\r\n                className=\"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2 block\"\r\n              >\r\n                Email Address\r\n              </label>\r\n              <Input\r\n                id=\"email\"\r\n                type=\"email\"\r\n                placeholder=\"colleague@example.com\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                className=\"w-full h-11 text-base border-2 border-slate-200 dark:border-slate-600 focus:border-blue-500 dark:focus:border-blue-400 rounded-lg\"\r\n                onKeyPress={(e) => e.key === \"Enter\" && handleShare()}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label\r\n                htmlFor=\"permission\"\r\n                className=\"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2 block\"\r\n              >\r\n                Permission Level\r\n              </label>\r\n              <div className=\"grid grid-cols-3 gap-2\">\r\n                {[\r\n                  {\r\n                    value: \"VIEWER\",\r\n                    icon: \"üëÅ\",\r\n                    label: \"Viewer\",\r\n                    desc: \"View only\",\r\n                  },\r\n                  {\r\n                    value: \"EDITOR\",\r\n                    icon: \"‚úèÔ∏è\",\r\n                    label: \"Editor\",\r\n                    desc: \"Can edit\",\r\n                  },\r\n                  {\r\n                    value: \"ADMIN\",\r\n                    icon: \"üëë\",\r\n                    label: \"Admin\",\r\n                    desc: \"Full access\",\r\n                  },\r\n                ].map((perm) => (\r\n                  <button\r\n                    key={perm.value}\r\n                    onClick={() => setPermission(perm.value as any)}\r\n                    className={`p-3 rounded-lg border-2 transition-all duration-200 text-center ${\r\n                      permission === perm.value\r\n                        ? \"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300\"\r\n                        : \"border-slate-200 dark:border-slate-600 hover:border-slate-300 dark:hover:border-slate-500 text-slate-600 dark:text-slate-300\"\r\n                    }`}\r\n                  >\r\n                    <div className=\"text-2xl mb-1\">{perm.icon}</div>\r\n                    <div className=\"text-xs font-medium\">{perm.label}</div>\r\n                    <div className=\"text-xs opacity-75\">{perm.desc}</div>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n              <div className=\"mt-2 text-xs text-slate-500 dark:text-slate-400\">\r\n                {getPermissionDescription(permission)}\r\n              </div>\r\n            </div>\r\n\r\n            <Button\r\n              onClick={handleShare}\r\n              disabled={!email.trim() || isSharing}\r\n              className=\"w-full h-11 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-medium rounded-lg shadow-lg hover:shadow-xl transition-all duration-200\"\r\n            >\r\n              {isSharing ? (\r\n                <div className=\"flex items-center gap-2\">\r\n                  <svg\r\n                    className=\"w-4 h-4 animate-spin\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n                    />\r\n                  </svg>\r\n                  Sharing...\r\n                </div>\r\n              ) : (\r\n                <div className=\"flex items-center gap-2\">\r\n                  <svg\r\n                    className=\"w-4 h-4\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M12 4v16m8-8H4\"\r\n                    />\r\n                  </svg>\r\n                  Share\r\n                </div>\r\n              )}\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Current Collaborators */}\r\n          {loadingAccess ? (\r\n            <div className=\"flex justify-center items-center p-8 text-blue-500\">\r\n              <svg\r\n                className=\"w-6 h-6 animate-spin mr-3\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n                />\r\n              </svg>\r\n              Loading collaborators...\r\n            </div>\r\n          ) : (\r\n            shareResults.length > 0 && (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h4 className=\"text-sm font-semibold text-slate-700 dark:text-slate-300\">\r\n                    Current Collaborators ({shareResults.length})\r\n                  </h4>\r\n                  <div className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                    Click √ó to remove access\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-3\">\r\n                  {shareResults.map((result, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 hover:shadow-md transition-all duration-200\"\r\n                    >\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-lg\">\r\n                          {result.user.name?.[0] ||\r\n                            result.user.email?.[0] ||\r\n                            \"U\"}\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-slate-900 dark:text-white\">\r\n                            {result.user.name || result.user.email}\r\n                          </div>\r\n                          <div className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                            {result.user.email}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <span\r\n                          className={`text-xs px-3 py-1.5 rounded-full font-medium border ${getPermissionColor(\r\n                            result.permission\r\n                          )}`}\r\n                        >\r\n                          <span className=\"mr-1\">\r\n                            {getPermissionIcon(result.permission)}\r\n                          </span>\r\n                          {result.permission}\r\n                        </span>\r\n\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleRemoveAccess(result.user.id)}\r\n                          className=\"text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg p-2 transition-all duration-200\"\r\n                          title=\"Remove access\"\r\n                        >\r\n                          <svg\r\n                            className=\"w-4 h-4\"\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              strokeWidth={2}\r\n                              d=\"M6 18L18 6M6 6l12 12\"\r\n                            />\r\n                          </svg>\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )\r\n          )}\r\n\r\n          {/* Footer */}\r\n          <div className=\"flex justify-end pt-4 border-t border-slate-200 dark:border-slate-700\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={onClose}\r\n              className=\"px-6 py-2 border-2 border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-lg font-medium\"\r\n            >\r\n              Done\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 930, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/components/DocumentList.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useMemo } from \"react\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { ApolloClient, InMemoryCache, HttpLink } from \"@apollo/client\";\r\nimport { useQuery, useMutation } from \"@apollo/client/react\";\r\nimport { gql } from \"@apollo/client/core\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/Card\";\r\nimport { ShareDialog } from \"@/components/ShareDialog\";\r\n\r\nconst GET_MY_DOCUMENTS = gql`\r\n  query GetMyDocuments {\r\n    myDocuments {\r\n      id\r\n      title\r\n      type\r\n      createdAt\r\n      updatedAt\r\n      owner {\r\n        id\r\n        name\r\n        email\r\n      }\r\n      access {\r\n        id\r\n        user {\r\n          id\r\n          name\r\n          email\r\n        }\r\n        permission\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst GET_SHARED_DOCUMENTS = gql`\r\n  query GetSharedDocuments {\r\n    sharedDocuments {\r\n      id\r\n      title\r\n      type\r\n      createdAt\r\n      updatedAt\r\n      owner {\r\n        id\r\n        name\r\n        email\r\n      }\r\n      access {\r\n        id\r\n        user {\r\n          id\r\n          name\r\n          email\r\n        }\r\n        permission\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst GET_DOCUMENT_ACCESS = gql`\r\n  query GetDocumentAccess($documentId: String!) {\r\n    document(id: $documentId) {\r\n      id\r\n      access {\r\n        id\r\n        user {\r\n          id\r\n          name\r\n          email\r\n        }\r\n        permission\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst CREATE_DOCUMENT_MUTATION = gql`\r\n  mutation CreateDocument($title: String!, $type: String!) {\r\n    createDocument(title: $title, type: $type) {\r\n      id\r\n      title\r\n      type\r\n      content\r\n      createdAt\r\n      updatedAt\r\n      owner {\r\n        id\r\n        name\r\n        email\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst DELETE_DOCUMENT_MUTATION = gql`\r\n  mutation DeleteDocument($id: String!) {\r\n    deleteDocument(id: $id)\r\n  }\r\n`;\r\n\r\ninterface DocumentListProps {\r\n  onDocumentSelect: (\r\n    id: string,\r\n    type: \"planning\" | \"drawing\" | \"writing\"\r\n  ) => void;\r\n}\r\n\r\nexport function DocumentList({ onDocumentSelect }: DocumentListProps) {\r\n  const { data: session } = useSession();\r\n  const [activeTab, setActiveTab] = useState<\"my\" | \"shared\">(\"my\");\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [shareDialog, setShareDialog] = useState<{\r\n    isOpen: boolean;\r\n    documentId: string;\r\n    title: string;\r\n  }>({\r\n    isOpen: false,\r\n    documentId: \"\",\r\n    title: \"\",\r\n  });\r\n  const [deleteDialog, setDeleteDialog] = useState<{\r\n    isOpen: boolean;\r\n    documentId: string;\r\n    documentTitle: string;\r\n  }>({\r\n    isOpen: false,\r\n    documentId: \"\",\r\n    documentTitle: \"\",\r\n  });\r\n  const [newDocumentTitle, setNewDocumentTitle] = useState(\"\");\r\n  const [newDocumentType, setNewDocumentType] = useState<\r\n    \"writing\" | \"drawing\" | \"planning\"\r\n  >(\"writing\");\r\n\r\n  const client = useMemo(\r\n    () =>\r\n      new ApolloClient({\r\n        link: new HttpLink({\r\n          uri: \"/api/graphql\",\r\n          credentials: \"include\",\r\n          headers: {\r\n            ...(session && {\r\n              \"x-user-id\": session.user?.id || \"\",\r\n            }),\r\n          },\r\n        }),\r\n        cache: new InMemoryCache(),\r\n      }),\r\n    [session?.user?.id]\r\n  );\r\n\r\n  const { data: myDocuments, refetch: refetchMyDocuments } = useQuery(\r\n    GET_MY_DOCUMENTS,\r\n    {\r\n      skip: !session,\r\n      client,\r\n    }\r\n  ) as any;\r\n\r\n  const { data: sharedDocuments, refetch: refetchSharedDocuments } = useQuery(\r\n    GET_SHARED_DOCUMENTS,\r\n    {\r\n      skip: !session,\r\n      client,\r\n    }\r\n  ) as any;\r\n\r\n  const { data: documentAccess, refetch: refetchDocumentAccess } = useQuery(\r\n    GET_DOCUMENT_ACCESS,\r\n    {\r\n      variables: { documentId: shareDialog.documentId },\r\n      skip: !shareDialog.documentId || !session,\r\n      client,\r\n    }\r\n  ) as any;\r\n\r\n  const [createDocument] = useMutation(CREATE_DOCUMENT_MUTATION, { client });\r\n  const [deleteDocument] = useMutation(DELETE_DOCUMENT_MUTATION, { client });\r\n\r\n  const handleCreateDocument = async () => {\r\n    if (!newDocumentTitle.trim()) return;\r\n\r\n    try {\r\n      const result = await createDocument({\r\n        variables: {\r\n          title: newDocumentTitle,\r\n          type: newDocumentType,\r\n        },\r\n        context: {\r\n          headers: {\r\n            \"x-user-id\": session?.user?.id || \"\",\r\n          },\r\n        },\r\n      });\r\n\r\n      console.log(\"Document created successfully:\", result);\r\n\r\n      setNewDocumentTitle(\"\");\r\n      setShowCreateModal(false);\r\n\r\n      // Force refresh with a small delay\r\n      setTimeout(async () => {\r\n        console.log(\"Refreshing document list...\");\r\n        await refetchMyDocuments();\r\n        await refetchSharedDocuments();\r\n        console.log(\"Document list refreshed\");\r\n      }, 500);\r\n    } catch (error) {\r\n      console.error(\"Error creating document:\", error);\r\n      // Even if there's an error, try to refresh\r\n      setTimeout(async () => {\r\n        await refetchMyDocuments();\r\n        await refetchSharedDocuments();\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n  const handleDeleteDocument = async (\r\n    documentId: string,\r\n    documentTitle: string\r\n  ) => {\r\n    // Show the modern delete confirmation modal\r\n    setDeleteDialog({\r\n      isOpen: true,\r\n      documentId,\r\n      documentTitle,\r\n    });\r\n  };\r\n\r\n  const confirmDelete = async () => {\r\n    const { documentId, documentTitle } = deleteDialog;\r\n\r\n    try {\r\n      console.log(\"Attempting to delete document:\", documentId);\r\n\r\n      const result = await deleteDocument({\r\n        variables: { id: documentId },\r\n        context: {\r\n          headers: {\r\n            \"x-user-id\": session?.user?.id || \"\",\r\n          },\r\n        },\r\n      });\r\n\r\n      console.log(\"Document deleted successfully:\", result);\r\n\r\n      // Show success message\r\n      const successMessage = document.createElement(\"div\");\r\n      successMessage.style.cssText = `\r\n        position: fixed;\r\n        top: 20px;\r\n        right: 20px;\r\n        background: #10b981;\r\n        color: white;\r\n        padding: 12px 20px;\r\n        border-radius: 8px;\r\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\r\n        z-index: 9999;\r\n        font-weight: 500;\r\n        animation: slideIn 0.3s ease-out;\r\n      `;\r\n      successMessage.textContent = `‚úì \"${documentTitle}\" deleted successfully`;\r\n      document.body.appendChild(successMessage);\r\n\r\n      // Remove success message after 3 seconds\r\n      setTimeout(() => {\r\n        if (successMessage.parentNode) {\r\n          successMessage.parentNode.removeChild(successMessage);\r\n        }\r\n      }, 3000);\r\n\r\n      // Close the delete dialog\r\n      setDeleteDialog({ isOpen: false, documentId: \"\", documentTitle: \"\" });\r\n\r\n      // Refresh the document list after deletion\r\n      setTimeout(async () => {\r\n        console.log(\"Refreshing document list after deletion...\");\r\n        await refetchMyDocuments();\r\n        await refetchSharedDocuments();\r\n        console.log(\"Document list refreshed after deletion\");\r\n      }, 500);\r\n    } catch (error) {\r\n      console.error(\"Error deleting document:\", error);\r\n\r\n      // Show error message\r\n      const errorMessage = document.createElement(\"div\");\r\n      errorMessage.style.cssText = `\r\n        position: fixed;\r\n        top: 20px;\r\n        right: 20px;\r\n        background: #ef4444;\r\n        color: white;\r\n        padding: 12px 20px;\r\n        border-radius: 8px;\r\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\r\n        z-index: 9999;\r\n        font-weight: 500;\r\n        animation: slideIn 0.3s ease-out;\r\n      `;\r\n      errorMessage.textContent = `‚úó Failed to delete \"${documentTitle}\"`;\r\n      document.body.appendChild(errorMessage);\r\n\r\n      // Remove error message after 3 seconds\r\n      setTimeout(() => {\r\n        if (errorMessage.parentNode) {\r\n          errorMessage.parentNode.removeChild(errorMessage);\r\n        }\r\n      }, 3000);\r\n\r\n      // Close the delete dialog\r\n      setDeleteDialog({ isOpen: false, documentId: \"\", documentTitle: \"\" });\r\n    }\r\n  };\r\n\r\n  const refetchDocuments = () => {\r\n    console.log(\"Document ID being shared:\", documentAccess);\r\n    console.log(\"=== REFETCHING DOCUMENTS ===\");\r\n    console.log(\"Document ID being shared:\", shareDialog.documentId);\r\n    console.log(\r\n      \"Current myDocuments count:\",\r\n      myDocuments?.myDocuments?.length || 0\r\n    );\r\n    console.log(\r\n      \"Current sharedDocuments count:\",\r\n      sharedDocuments?.sharedDocuments?.length || 0\r\n    );\r\n\r\n    setTimeout(async () => {\r\n      console.log(\"Refreshing document list after sharing...\");\r\n      await refetchMyDocuments();\r\n      await refetchSharedDocuments();\r\n      await refetchDocumentAccess(); // Also refresh specific document access\r\n      console.log(\"=== REFETCH COMPLETE ===\");\r\n      console.log(\r\n        \"New myDocuments count:\",\r\n        myDocuments?.myDocuments?.length || 0\r\n      );\r\n      console.log(\r\n        \"New sharedDocuments count:\",\r\n        sharedDocuments?.sharedDocuments?.length || 0\r\n      );\r\n      console.log(\"Document list refreshed after sharing\");\r\n    }, 500);\r\n  };\r\n\r\n  const handleShareDocument = (documentId: string, title: string) => {\r\n    setShareDialog({\r\n      isOpen: true,\r\n      documentId,\r\n      title,\r\n    });\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString();\r\n  };\r\n\r\n  const getDocumentIcon = (type: string) => {\r\n    switch (type) {\r\n      case \"planning\":\r\n        return \"üìã\";\r\n      case \"drawing\":\r\n        return \"üé®\";\r\n      case \"writing\":\r\n        return \"üìù\";\r\n      default:\r\n        return \"üìÑ\";\r\n    }\r\n  };\r\n\r\n  const getDocumentColor = (type: string) => {\r\n    switch (type) {\r\n      case \"planning\":\r\n        return \"bg-blue-100 text-blue-800\";\r\n      case \"drawing\":\r\n        return \"bg-purple-100 text-purple-800\";\r\n      case \"writing\":\r\n        return \"bg-green-100 text-green-800\";\r\n      default:\r\n        return \"bg-gray-100 text-gray-800\";\r\n    }\r\n  };\r\n\r\n  const documents =\r\n    activeTab === \"my\"\r\n      ? myDocuments?.myDocuments\r\n      : sharedDocuments?.sharedDocuments;\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800\">\r\n      <div className=\"p-6 border-b bg-white/80 backdrop-blur-sm dark:bg-slate-800/80 shadow-sm\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 dark:from-white dark:to-slate-300 bg-clip-text text-transparent\">\r\n              Workspace\r\n            </h2>\r\n            <p className=\"text-sm text-slate-500 dark:text-slate-400 mt-1\">\r\n              Manage your collaborative documents\r\n            </p>\r\n          </div>\r\n          <Button\r\n            size=\"sm\"\r\n            onClick={() => setShowCreateModal(true)}\r\n            className=\"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105\"\r\n          >\r\n            <svg\r\n              className=\"w-4 h-4 mr-2\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M12 4v16m8-8H4\"\r\n              />\r\n            </svg>\r\n            New Document\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"flex space-x-1 bg-slate-100 dark:bg-slate-700 p-1 rounded-xl shadow-inner\">\r\n          <Button\r\n            variant={activeTab === \"my\" ? \"default\" : \"ghost\"}\r\n            size=\"sm\"\r\n            onClick={() => setActiveTab(\"my\")}\r\n            className={`flex-1 rounded-lg transition-all duration-200 text-xs ${\r\n              activeTab === \"my\"\r\n                ? \"bg-white dark:bg-slate-600 shadow-md text-slate-900 dark:text-white\"\r\n                : \"text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white hover:bg-white/50 dark:hover:bg-slate-600/50\"\r\n            }`}\r\n          >\r\n            <span className=\"flex items-center justify-center gap-1 text-xs\">\r\n              üìÅ\r\n              <span className=\"hidden sm:inline\">My Documents</span>\r\n              {myDocuments?.myDocuments?.length > 0 && (\r\n                <span className=\"bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded-full\">\r\n                  {myDocuments.myDocuments.length}\r\n                </span>\r\n              )}\r\n            </span>\r\n          </Button>\r\n          <Button\r\n            variant={activeTab === \"shared\" ? \"default\" : \"ghost\"}\r\n            size=\"sm\"\r\n            onClick={() => setActiveTab(\"shared\")}\r\n            className={`flex-1 rounded-lg transition-all duration-200 text-xs ${\r\n              activeTab === \"shared\"\r\n                ? \"bg-white dark:bg-slate-600 shadow-md text-slate-900 dark:text-white\"\r\n                : \"text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white hover:bg-white/50 dark:hover:bg-slate-600/50\"\r\n            }`}\r\n          >\r\n            <span className=\"flex items-center justify-center gap-1 text-xs\">\r\n              ü§ù\r\n              <span className=\"hidden sm:inline\">Shared</span>\r\n              {sharedDocuments?.sharedDocuments?.length > 0 && (\r\n                <span className=\"bg-purple-500 text-white text-xs px-1.5 py-0.5 rounded-full\">\r\n                  {sharedDocuments.sharedDocuments.length}\r\n                </span>\r\n              )}\r\n            </span>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1 overflow-y-auto p-6\">\r\n        {documents?.length === 0 ? (\r\n          <div className=\"text-center py-16\">\r\n            <div className=\"w-24 h-24 bg-gradient-to-br from-slate-200 to-slate-300 dark:from-slate-700 dark:to-slate-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg\">\r\n              <svg\r\n                className=\"w-12 h-12 text-slate-400 dark:text-slate-500\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={1.5}\r\n                  d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-xl font-semibold text-slate-800 dark:text-slate-200 mb-3\">\r\n              {activeTab === \"my\" ? \"No documents yet\" : \"No shared documents\"}\r\n            </h3>\r\n            <p className=\"text-slate-500 dark:text-slate-400 max-w-sm mx-auto\">\r\n              {activeTab === \"my\"\r\n                ? \"Create your first document to start collaborating with your team\"\r\n                : \"Documents shared with you will appear here for easy access\"}\r\n            </p>\r\n            {activeTab === \"my\" && (\r\n              <Button\r\n                onClick={() => setShowCreateModal(true)}\r\n                className=\"mt-6 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105\"\r\n              >\r\n                <svg\r\n                  className=\"w-4 h-4 mr-2\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M12 4v16m8-8H4\"\r\n                  />\r\n                </svg>\r\n                Create Your First Document\r\n              </Button>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid gap-4\">\r\n            {documents?.map((doc: any) => (\r\n              <Card\r\n                key={doc.id}\r\n                className=\"group cursor-pointer hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border-0 bg-white dark:bg-slate-800 shadow-lg\"\r\n                onClick={() => onDocumentSelect(doc.id, doc.type)}\r\n              >\r\n                <CardContent className=\"p-3\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center space-x-3 mb-3\">\r\n                        <div className=\"text-3xl p-3 rounded-xl bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 shadow-inner\">\r\n                          {getDocumentIcon(doc.type)}\r\n                        </div>\r\n                        <div className=\"flex-1\">\r\n                          <h3 className=\"font-semibold text-lg text-slate-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors\">\r\n                            {doc.title}\r\n                          </h3>\r\n                          <div className=\"flex items-center space-x-2 mt-1\">\r\n                            <span\r\n                              className={`text-xs px-3 py-1 rounded-full font-medium shadow-sm ${getDocumentColor(\r\n                                doc.type\r\n                              )}`}\r\n                            >\r\n                              {doc.type}\r\n                            </span>\r\n                            {activeTab === \"shared\" && (\r\n                              <span className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                                by {doc.owner.name || doc.owner.email}\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2 ml-4\">\r\n                      {activeTab === \"my\" && (\r\n                        <>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              handleShareDocument(doc.id, doc.title);\r\n                            }}\r\n                            className=\"opacity-75 hover:opacity-100 transition-all duration-200 text-slate-600 dark:text-slate-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg p-2\"\r\n                            title=\"Share document\"\r\n                          >\r\n                            <svg\r\n                              className=\"w-4 h-4\"\r\n                              fill=\"none\"\r\n                              stroke=\"currentColor\"\r\n                              viewBox=\"0 0 24 24\"\r\n                            >\r\n                              <path\r\n                                strokeLinecap=\"round\"\r\n                                strokeLinejoin=\"round\"\r\n                                strokeWidth={2}\r\n                                d=\"M8.684 13.342C8.886 12.938 9 12.5 9 12c0-.5-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m9.032 4.026a3 3 0 10-4.732 2.684 3 3 0 004.732-2.684zm0 0a3 3 0 00-4.732-2.684 3 3 0 004.732 2.684z\"\r\n                              />\r\n                            </svg>\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              handleDeleteDocument(doc.id, doc.title);\r\n                            }}\r\n                            className=\"opacity-75 hover:opacity-100 transition-all duration-200 text-slate-600 dark:text-slate-300 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg p-2\"\r\n                            title=\"Delete document\"\r\n                          >\r\n                            <svg\r\n                              className=\"w-4 h-4\"\r\n                              fill=\"none\"\r\n                              stroke=\"currentColor\"\r\n                              viewBox=\"0 0 24 24\"\r\n                            >\r\n                              <path\r\n                                strokeLinecap=\"round\"\r\n                                strokeLinejoin=\"round\"\r\n                                strokeWidth={2}\r\n                                d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\r\n                              />\r\n                            </svg>\r\n                          </Button>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center space-x-4 text-sm text-slate-500 dark:text-slate-400\">\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <svg\r\n                          className=\"w-4 h-4\"\r\n                          fill=\"none\"\r\n                          stroke=\"currentColor\"\r\n                          viewBox=\"0 0 24 24\"\r\n                        >\r\n                          <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            strokeWidth={2}\r\n                            d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"\r\n                          />\r\n                        </svg>\r\n                        {formatDate(doc.updatedAt)}\r\n                      </span>\r\n                      {doc.access?.length > 0 && (\r\n                        <span className=\"flex items-center gap-1 text-blue-600 dark:text-blue-400\">\r\n                          <svg\r\n                            className=\"w-4 h-4\"\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              strokeWidth={2}\r\n                              d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\"\r\n                            />\r\n                          </svg>\r\n                          {doc.access.length} collaborators\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {showCreateModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <Card className=\"w-full max-w-md\">\r\n            <CardHeader>\r\n              <CardTitle>Create New Document</CardTitle>\r\n              <CardDescription>\r\n                Start a new collaborative document\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"space-y-2\">\r\n                <label htmlFor=\"title\" className=\"text-sm font-medium\">\r\n                  Title\r\n                </label>\r\n                <Input\r\n                  id=\"title\"\r\n                  placeholder=\"Enter document title\"\r\n                  value={newDocumentTitle}\r\n                  onChange={(e) => setNewDocumentTitle(e.target.value)}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <label htmlFor=\"type\" className=\"text-sm font-medium\">\r\n                  Document Type\r\n                </label>\r\n                <select\r\n                  id=\"type\"\r\n                  value={newDocumentType}\r\n                  onChange={(e) => setNewDocumentType(e.target.value as any)}\r\n                  className=\"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\"\r\n                >\r\n                  <option value=\"writing\">üìù Writing Document</option>\r\n                  <option value=\"drawing\">üé® Drawing Canvas</option>\r\n                  <option value=\"planning\">üìã Planning Board</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end space-x-2 pt-4\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => setShowCreateModal(false)}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n                <Button\r\n                  onClick={handleCreateDocument}\r\n                  disabled={!newDocumentTitle.trim()}\r\n                >\r\n                  Create Document\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      )}\r\n\r\n      <ShareDialog\r\n        documentId={shareDialog.documentId}\r\n        documentTitle={shareDialog.title}\r\n        isOpen={shareDialog.isOpen}\r\n        onClose={() =>\r\n          setShareDialog({ isOpen: false, documentId: \"\", title: \"\" })\r\n        }\r\n        onShareComplete={refetchDocuments}\r\n      />\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      {deleteDialog.isOpen && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <Card className=\"w-full max-w-md\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-destructive flex items-center gap-2\">\r\n                <svg\r\n                  className=\"w-5 h-5\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\"\r\n                  />\r\n                </svg>\r\n                Delete Document\r\n              </CardTitle>\r\n              <CardDescription>\r\n                Are you sure you want to delete \"{deleteDialog.documentTitle}\"?\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-3\">\r\n                <p className=\"text-sm text-destructive font-medium\">\r\n                  ‚ö†Ô∏è This action cannot be undone\r\n                </p>\r\n                <p className=\"text-sm text-muted-foreground mt-1\">\r\n                  All shared access will be removed and the document will be\r\n                  permanently deleted.\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end space-x-2 pt-4\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() =>\r\n                    setDeleteDialog({\r\n                      isOpen: false,\r\n                      documentId: \"\",\r\n                      documentTitle: \"\",\r\n                    })\r\n                  }\r\n                >\r\n                  Cancel\r\n                </Button>\r\n                <Button\r\n                  variant=\"destructive\"\r\n                  onClick={confirmDelete}\r\n                  className=\"min-w-[100px]\"\r\n                >\r\n                  Delete\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2099, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/lib/crdt/provider.ts"],"sourcesContent":["import * as Y from \"yjs\";\r\nimport { WebsocketProvider } from \"y-websocket\";\r\n\r\nexport class CRDTProvider {\r\n  private doc: Y.Doc;\r\n  private provider: WebsocketProvider;\r\n  private documentId: string;\r\n  private userId: string;\r\n  private syncCallbacks: ((isSynced: boolean) => void)[] = [];\r\n  private awarenessCallbacks: ((updates: any) => void)[] = [];\r\n\r\n  constructor(documentId: string, userId: string) {\r\n    this.documentId = documentId;\r\n    this.userId = userId;\r\n    this.doc = new Y.Doc();\r\n\r\n    // Initialize WebSocket provider for real-time collaboration\r\n    this.provider = new WebsocketProvider(\r\n      process.env.WEBSOCKET_URL || \"ws://localhost:1234\",\r\n      documentId,\r\n      this.doc,\r\n      {\r\n        connect: true,\r\n        // Add authentication parameters\r\n        params: {\r\n          userId,\r\n          room: documentId,\r\n        },\r\n        // Add connection options for resilience\r\n        // Remove invalid connection option\r\n      }\r\n    );\r\n\r\n    // Set up user awareness with proper info\r\n    this.setupUserAwareness();\r\n    this.setupEventListeners();\r\n  }\r\n\r\n  private setupUserAwareness() {\r\n    // Set initial user state\r\n    this.provider.awareness.setLocalStateField(\"user\", {\r\n      id: this.userId,\r\n      name: this.getUserName(),\r\n      email: this.getUserEmail(),\r\n      color: this.getUserColor(this.userId),\r\n      cursor: { x: 0, y: 0 },\r\n      isActive: true,\r\n    });\r\n  }\r\n\r\n  private setupEventListeners() {\r\n    // Connection status events\r\n    this.provider.on(\"status\", (event: any) => {\r\n      console.log(\"WebSocket status:\", event.status);\r\n      const isConnected = event.status === \"connected\";\r\n      this.syncCallbacks.forEach((callback) => callback(isConnected));\r\n    });\r\n\r\n    // Sync events\r\n    this.provider.on(\"sync\", (isSynced: boolean) => {\r\n      this.syncCallbacks.forEach((callback) => callback(isSynced));\r\n    });\r\n\r\n    // Awareness events for user presence\r\n    this.provider.awareness.on(\"update\", (updates: any) => {\r\n      this.awarenessCallbacks.forEach((callback) => callback(updates));\r\n    });\r\n\r\n    // Connection events - use type assertion to bypass TypeScript checking\r\n    this.provider.on(\"connect\" as any, () => {\r\n      console.log(`Connected to room: ${this.documentId}`);\r\n      this.syncCallbacks.forEach((callback) => callback(true));\r\n    });\r\n\r\n    this.provider.on(\"disconnect\" as any, () => {\r\n      console.log(`Disconnected from room: ${this.documentId}`);\r\n      this.syncCallbacks.forEach((callback) => callback(false));\r\n    });\r\n  }\r\n\r\n  // Get Y.js data structures\r\n  getText(name: string = \"content\"): Y.Text {\r\n    return this.doc.getText(name);\r\n  }\r\n\r\n  getArray(name: string = \"tasks\"): Y.Array<any> {\r\n    return this.doc.getArray(name);\r\n  }\r\n\r\n  getMap(name: string = \"drawing\"): Y.Map<any> {\r\n    return this.doc.getMap(name);\r\n  }\r\n\r\n  // Get connected users from awareness\r\n  getConnectedUsers(): any[] {\r\n    if (!this.provider?.awareness) return [];\r\n\r\n    return Array.from(this.provider.awareness.getStates().values())\r\n      .filter((state) => state.user && state.user.id !== this.userId)\r\n      .map((state) => ({\r\n        id: state.user.id,\r\n        name: state.user.name || `User ${state.user.id}`,\r\n        email: state.user.email || \"\",\r\n        cursor: state.user.cursor || { x: 0, y: 0 },\r\n        color: state.user.color || this.getUserColor(state.user.id),\r\n        isActive: state.user.isActive !== false,\r\n        lastSeen: new Date().toISOString(),\r\n      }));\r\n  }\r\n\r\n  // Update user cursor position\r\n  updateCursor(x: number, y: number) {\r\n    if (!this.provider?.awareness) return;\r\n\r\n    const currentState = this.provider.awareness.getLocalState() || {};\r\n    const userState = {\r\n      ...currentState.user,\r\n      cursor: { x, y },\r\n    };\r\n\r\n    this.provider.awareness.setLocalStateField(\"user\", userState);\r\n  }\r\n\r\n  // Get document state\r\n  getDocument(): Y.Doc {\r\n    return this.doc;\r\n  }\r\n\r\n  // Sync with database\r\n  async syncWithDatabase(content?: Buffer): Promise<Buffer> {\r\n    if (content) {\r\n      // Load from database\r\n      try {\r\n        const state = new Uint8Array(content);\r\n        Y.applyUpdate(this.doc, state);\r\n      } catch (error) {\r\n        console.error(\"Error applying database update:\", error);\r\n      }\r\n    }\r\n\r\n    // Save to database\r\n    try {\r\n      const state = Y.encodeStateAsUpdate(this.doc);\r\n      const buffer = Buffer.from(state);\r\n      return buffer;\r\n    } catch (error) {\r\n      console.error(\"Error encoding state:\", error);\r\n      return Buffer.alloc(0);\r\n    }\r\n  }\r\n\r\n  // Event listeners\r\n  onSync(callback: (isSynced: boolean) => void) {\r\n    this.syncCallbacks.push(callback);\r\n  }\r\n\r\n  onAwarenessUpdate(callback: (updates: any) => void) {\r\n    this.awarenessCallbacks.push(callback);\r\n  }\r\n\r\n  // Utility methods\r\n  private getUserColor(userId: string): string {\r\n    const colors = [\r\n      \"#ef4444\",\r\n      \"#f59e0b\",\r\n      \"#10b981\",\r\n      \"#3b82f6\",\r\n      \"#8b5cf6\",\r\n      \"#ec4899\",\r\n    ];\r\n    const index = userId.charCodeAt(0) % colors.length;\r\n    return colors[index];\r\n  }\r\n\r\n  private getUserName(): string {\r\n    // Try to get user info from session or localStorage\r\n    if (typeof window !== \"undefined\") {\r\n      try {\r\n        const sessionElement = document.querySelector(\"[data-session]\");\r\n        if (sessionElement) {\r\n          const sessionData = sessionElement.getAttribute(\"data-session\");\r\n          if (sessionData) {\r\n            const session = JSON.parse(sessionData);\r\n            return session.user?.name || `User ${this.userId}`;\r\n          }\r\n        }\r\n      } catch {\r\n        // Fallback to localStorage\r\n        const session = localStorage.getItem(\"next-auth.session-token\");\r\n        return session ? `User ${this.userId}` : \"Anonymous User\";\r\n      }\r\n    }\r\n    return `User ${this.userId}`;\r\n  }\r\n\r\n  private getUserEmail(): string {\r\n    if (typeof window !== \"undefined\") {\r\n      try {\r\n        const sessionElement = document.querySelector(\"[data-session]\");\r\n        if (sessionElement) {\r\n          const sessionData = sessionElement.getAttribute(\"data-session\");\r\n          if (sessionData) {\r\n            const session = JSON.parse(sessionData);\r\n            return session.user?.email || \"\";\r\n          }\r\n        }\r\n      } catch {\r\n        return \"\";\r\n      }\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  // Cleanup\r\n  destroy() {\r\n    if (this.provider) {\r\n      this.provider.destroy();\r\n    }\r\n    this.doc.destroy();\r\n    this.syncCallbacks = [];\r\n    this.awarenessCallbacks = [];\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2279, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/components/DocumentEditor.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useRef, useMemo, useCallback } from \"react\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { CRDTProvider } from \"@/lib/crdt/provider\";\r\nimport { ApolloClient, InMemoryCache, HttpLink } from \"@apollo/client\";\r\nimport { useSubscription, useMutation, useQuery } from \"@apollo/client/react\";\r\nimport { gql } from \"@apollo/client/core\";\r\nimport { Button } from \"@/components/ui/Button\";\r\n\r\ninterface DocumentEditorProps {\r\n  documentId: string;\r\n  documentType: \"planning\" | \"drawing\" | \"writing\";\r\n}\r\n\r\nconst GET_DOCUMENT_QUERY = gql`\r\n  query GetDocument($id: String!) {\r\n    document(id: $id) {\r\n      id\r\n      title\r\n      type\r\n      content\r\n      createdAt\r\n      updatedAt\r\n      owner {\r\n        id\r\n        name\r\n        email\r\n      }\r\n    }\r\n  }\r\n`;\r\nconst DOCUMENT_UPDATED_SUBSCRIPTION = gql`\r\n  subscription DocumentUpdated($documentId: String!) {\r\n    documentUpdated(documentId: $documentId) {\r\n      id\r\n      title\r\n      content\r\n      updatedAt\r\n    }\r\n  }\r\n`;\r\nconst UPDATE_DOCUMENT_MUTATION = gql`\r\n  mutation UpdateDocument($id: String!, $title: String, $content: Bytes) {\r\n    updateDocument(id: $id, title: $title, content: $content) {\r\n      id\r\n      title\r\n      content\r\n      updatedAt\r\n    }\r\n  }\r\n`;\r\nconst ACTIVE_USERS_SUBSCRIPTION = gql`\r\n  subscription ActiveUsers($documentId: String!) {\r\n    activeUsers(documentId: $documentId) {\r\n      id\r\n      name\r\n      email\r\n      cursor {\r\n        x\r\n        y\r\n      }\r\n      color\r\n      isActive\r\n      lastSeen\r\n    }\r\n  }\r\n`;\r\n\r\nexport function DocumentEditor({\r\n  documentId,\r\n  documentType,\r\n}: DocumentEditorProps) {\r\n  const { data: session } = useSession();\r\n  const [crdtProvider, setCrdtProvider] = useState<CRDTProvider | null>(null);\r\n  const [title, setTitle] = useState(\"\");\r\n  const [connectedUsers, setConnectedUsers] = useState<any[]>([]);\r\n  const [roomInfo, setRoomInfo] = useState({\r\n    id: documentId,\r\n    type: documentType,\r\n  });\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [showCopyNotification, setShowCopyNotification] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\r\n  const editorRef = useRef<HTMLDivElement>(null);\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n  // Create Apollo Client for document queries\r\n  const client = useMemo(\r\n    () =>\r\n      new ApolloClient({\r\n        link: new HttpLink({\r\n          uri: \"/api/graphql\",\r\n          credentials: \"include\",\r\n          headers: session?.user?.id ? { \"x-user-id\": session.user.id } : {},\r\n        }),\r\n        cache: new InMemoryCache(),\r\n      }),\r\n    [session?.user?.id]\r\n  );\r\n  \r\n  // Query document details\r\n  const { data: documentData } = useQuery(GET_DOCUMENT_QUERY, {\r\n    variables: { id: documentId },\r\n    skip: !documentId,\r\n    client,\r\n  }) as any;\r\n  const { data: subscriptionData } = useSubscription(\r\n    DOCUMENT_UPDATED_SUBSCRIPTION,\r\n    {\r\n      variables: { documentId },\r\n      skip: !documentId,\r\n    }\r\n  ) as any;\r\n  const { data: activeUsersData } = useSubscription(ACTIVE_USERS_SUBSCRIPTION, {\r\n    variables: { documentId },\r\n    skip: !documentId,\r\n  }) as any;\r\n  const [updateDocument] = useMutation(UPDATE_DOCUMENT_MUTATION, {\r\n    client,\r\n    context: {\r\n      headers: {\r\n        ...(session && {\r\n          \"x-user-id\": session.user?.id || \"\",\r\n        }),\r\n      },\r\n    },\r\n  });\r\n\r\n  // Set title when document data loads\r\n  useEffect(() => {\r\n    if (!documentData?.document?.title) return;\r\n    setTitle((prev) => prev || documentData.document.title);\r\n  }, [documentData?.document?.title]);\r\nuseEffect(() => {\r\n  if (!session?.user?.id || !documentId) return;\r\n\r\n  const provider = new CRDTProvider(documentId, session.user.id);\r\n  setCrdtProvider(provider);\r\n\r\n  provider.onSync(setIsConnected);\r\n  provider.onAwarenessUpdate(() => {\r\n    setConnectedUsers(provider.getConnectedUsers());\r\n  });\r\n\r\n  return () => provider.destroy();\r\n}, [documentId, session?.user?.id]);\r\n  useEffect(() => {\r\n    if (subscriptionData?.documentUpdated && crdtProvider) {\r\n      // Handle real-time updates\r\n      console.log(\"Document updated:\", subscriptionData.documentUpdated);\r\n    }\r\n  }, [subscriptionData, crdtProvider]);\r\n  useEffect(() => {\r\n    if (activeUsersData?.activeUsers) {\r\n      setConnectedUsers(activeUsersData.activeUsers);\r\n    }\r\n  }, [activeUsersData]);\r\n\r\n  const handleTitleChange = (newTitle: string) => {\r\n    setTitle(newTitle);\r\n  };\r\n\r\n  const handleAutoSave = async () => {\r\n    if (crdtProvider) {\r\n      try {\r\n        const content = await crdtProvider.syncWithDatabase();\r\n        await updateDocument({\r\n          variables: {\r\n            id: documentId,\r\n            title: title,\r\n          },\r\n        });\r\n        console.log(\"Auto-saved document successfully\");\r\n      } catch (error) {\r\n        console.error(\"Auto-save failed:\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getUserColor = (userId: string) => {\r\n    const colors = [\r\n      \"#ef4444\",\r\n      \"#f59e0b\",\r\n      \"#10b981\",\r\n      \"#3b82f6\",\r\n      \"#8b5cf6\",\r\n      \"#ec4899\",\r\n    ];\r\n    const index = userId.charCodeAt(0) % colors.length;\r\n    return colors[index];\r\n  };\r\n  const handleSave = useCallback(async () => {\r\n    if (!crdtProvider || isSaving) return;\r\n\r\n    try {\r\n      setIsSaving(true);\r\n      console.log(\"Starting save process for document type:\", documentType);\r\n      \r\n      // Force sync with database - this will get latest content from all editors\r\n      const content = await crdtProvider.syncWithDatabase();\r\n      console.log(\"Content synced, size:\", content.length);\r\n      console.log(\"Document title being saved:\", title);\r\n      \r\n      // Update document via GraphQL (title and content)\r\n      const result = await updateDocument({\r\n        variables: { id: documentId, title, content },\r\n      });\r\n      console.log(\"GraphQL update result:\", result);\r\n      \r\n      setLastSaved(new Date());\r\n      console.log(\"Document saved successfully\");\r\n      \r\n      // Show success feedback\r\n      if ((result as any)?.data?.updateDocument) {\r\n        console.log(\"Document updated in database\");\r\n        // Optional: Show success toast\r\n        alert(\"Document saved successfully!\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Save failed:\", error);\r\n      // Show error feedback to user\r\n      alert(`Save failed: ${error instanceof Error ? error.message : \"Unknown error\"}`);\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  }, [crdtProvider, documentId, title, updateDocument, isSaving]);\r\nconst editor = useMemo(() => {\r\n  if (!crdtProvider) return null;\r\n\r\n  switch (documentType) {\r\n    case \"writing\":\r\n      return <WritingEditor crdtProvider={crdtProvider} onSave={handleSave} />;\r\n    case \"drawing\":\r\n      return <DrawingEditor crdtProvider={crdtProvider} canvasRef={canvasRef} onSave={handleSave} />;\r\n    case \"planning\":\r\n      return <PlanningEditor crdtProvider={crdtProvider} onSave={handleSave} />;\r\n    default:\r\n      return null;\r\n  }\r\n}, [documentType, crdtProvider, handleSave]);\r\n\r\n  // Add keyboard shortcut for save\r\nuseEffect(() => {\r\n  const listener = (e: KeyboardEvent) => {\r\n    if ((e.ctrlKey || e.metaKey) && e.key === \"s\") {\r\n      e.preventDefault();\r\n      handleSave();\r\n    }\r\n  };\r\n  window.addEventListener(\"keydown\", listener);\r\n  return () => window.removeEventListener(\"keydown\", listener);\r\n}, [handleSave]);\r\n  return (\r\n    <div className=\"flex flex-col h-full\">\r\n      {/* Header with Room Info */}\r\n      <div className=\"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\r\n        <div className=\"container flex h-16 items-center justify-between px-4\">\r\n          <div className=\"flex items-center space-x-4\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <div\r\n                className={`w-2 h-2 rounded-full ${\r\n                  isConnected ? \"bg-green-500\" : \"bg-red-500\"\r\n                }`}\r\n              />\r\n              <span className=\"text-sm text-muted-foreground\">\r\n                {isConnected ? \"Connected\" : \"Disconnected\"}\r\n              </span>\r\n            </div>\r\n\r\n            {/* Room ID - More Prominent */}\r\n            <div className=\"flex items-center space-x-2 bg-muted/50 px-3 py-2 rounded-md border\">\r\n              <span className=\"text-xs text-muted-foreground\">Room:</span>\r\n              <span className=\"font-mono font-bold text-primary text-sm\">\r\n                {roomInfo.id}\r\n              </span>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  navigator.clipboard.writeText(roomInfo.id);\r\n                  setShowCopyNotification(true);\r\n                  setTimeout(() => setShowCopyNotification(false), 2000);\r\n                }}\r\n                className=\"ml-2\"\r\n                title=\"Copy Room ID\"\r\n              >\r\n                üìã Copy\r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              Type:{\" \"}\r\n              <span className=\"font-medium text-foreground capitalize\">\r\n                {roomInfo.type}\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-4\">\r\n            {/* Active Users */}\r\n            <div className=\"flex items-center space-x-2\">\r\n              <div className=\"flex -space-x-2\">\r\n                {connectedUsers.map((user) => (\r\n                  <div\r\n                    key={user.id}\r\n                    className=\"w-6 h-6 rounded-full border-2 border-background flex items-center justify-center\"\r\n                    style={{ backgroundColor: getUserColor(user.id) }}\r\n                    title={user.name || user.email}\r\n                  >\r\n                    <span className=\"text-xs text-white font-medium\">\r\n                      {user.name?.[0] || user.email?.[0] || \"U\"}\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <span className=\"text-sm text-muted-foreground\">\r\n                {connectedUsers.length} active\r\n              </span>\r\n            </div>\r\n            <Button \r\n              onClick={handleSave}\r\n              disabled={isSaving}\r\n              className=\"flex items-center space-x-2\"\r\n            >\r\n              {isSaving ? (\r\n                <>\r\n                  <svg className=\"w-4 h-4 animate-spin\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n                  </svg>\r\n                  Saving...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V2\" />\r\n                  </svg>\r\n                  Save\r\n                </>\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Document Title */}\r\n      <div className=\"border-b bg-muted/30 px-4 py-3\">\r\n        <input\r\n          type=\"text\"\r\n          value={title}\r\n          onChange={(e) => handleTitleChange(e.target.value)}\r\n          className=\"text-xl font-semibold bg-transparent border-none outline-none w-full\"\r\n          placeholder=\"Document title\"\r\n        />\r\n      </div>\r\n\r\n      {/* Document Content */}\r\n      <div className=\"flex-1 relative overflow-hidden\">\r\n{editor}\r\n\r\n        {/* Live Cursors for Drawing */}\r\n        {documentType === \"drawing\" &&\r\n          connectedUsers.map(\r\n            (user) =>\r\n              user.cursor && (\r\n                <div\r\n                  key={user.id}\r\n                  className=\"absolute w-4 h-4 rounded-full border-2 border-white pointer-events-none\"\r\n                  style={{\r\n                    left: user.cursor.x,\r\n                    top: user.cursor.y,\r\n                    backgroundColor: getUserColor(user.id),\r\n                    transform: \"translate(-50%, -50%)\",\r\n                  }}\r\n                  title={user.name || user.email}\r\n                />\r\n              )\r\n          )}\r\n      </div>\r\n\r\n      {/* Status Bar */}\r\n      <div className=\"border-t bg-muted/30 px-4 py-2\">\r\n        <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n          <div>Last updated: {lastSaved ? lastSaved.toLocaleTimeString() : new Date().toLocaleTimeString()}</div>\r\n          <div>\r\n            {connectedUsers.map((user) => (\r\n              <span key={user.id} className=\"inline-flex items-center mr-3\">\r\n                <div\r\n                  className=\"w-2 h-2 rounded-full mr-1\"\r\n                  style={{ backgroundColor: getUserColor(user.id) }}\r\n                />\r\n                {user.name || user.email}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Copy Notification Toast */}\r\n      {showCopyNotification && (\r\n        <div className=\"fixed bottom-4 right-4 bg-primary text-primary-foreground px-4 py-2 rounded-md shadow-lg z-50\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span>üìã Room ID copied to clipboard!</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction WritingEditor({\r\n  crdtProvider,\r\n  onSave,\r\n}: {\r\n  crdtProvider: CRDTProvider | null;\r\n  onSave?: () => Promise<void>;\r\n}) {\r\n  const [content, setContent] = useState(\"\");\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\r\n  const [wordCount, setWordCount] = useState(0);\r\n  const [charCount, setCharCount] = useState(0);\r\n  const [readingTime, setReadingTime] = useState(0);\r\n  const [isFullscreen, setIsFullscreen] = useState(false);\r\n  const [fontSize, setFontSize] = useState(\"16\");\r\n  const [showToolbar, setShowToolbar] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!crdtProvider) return;\r\n\r\n    const yText = crdtProvider.getText(\"content\");\r\n    setContent(yText.toString());\r\n\r\n    const observer = () => {\r\n      const newContent = yText.toString();\r\n      setContent(newContent);\r\n      updateStats(newContent);\r\n      \r\n      // Trigger auto-save after content changes\r\n      const timeoutId = setTimeout(() => {\r\n        handleAutoSave();\r\n      }, 1000); // Auto-save after 1 second of inactivity\r\n\r\n      return () => clearTimeout(timeoutId);\r\n    };\r\n\r\n    yText.observe(observer);\r\n    return () => yText.unobserve(observer);\r\n  }, [crdtProvider]);\r\n\r\n  const updateStats = (text: string) => {\r\n    const words = text.trim().split(/\\s+/).filter(word => word.length > 0).length;\r\n    const chars = text.length;\r\n    const readingMins = Math.ceil(words / 200); // Average reading speed: 200 words/min\r\n    \r\n    setWordCount(words);\r\n    setCharCount(chars);\r\n    setReadingTime(readingMins);\r\n  };\r\n\r\n  const handleAutoSave = async () => {\r\n    if (!crdtProvider || isSaving) return;\r\n\r\n    setIsSaving(true);\r\n    try {\r\n      const content = await crdtProvider.syncWithDatabase();\r\n      console.log(\"Writing content auto-saved\");\r\n      setLastSaved(new Date());\r\n    } catch (error) {\r\n      console.error(\"Auto-save failed:\", error);\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    const newContent = e.target.value;\r\n    setContent(newContent);\r\n    updateStats(newContent);\r\n\r\n    if (crdtProvider) {\r\n      const yText = crdtProvider.getText(\"content\");\r\n      yText.delete(0, yText.length);\r\n      yText.insert(0, newContent);\r\n    }\r\n  };\r\n\r\n  const handleFormat = (format: string) => {\r\n    if (!crdtProvider) return;\r\n    \r\n    const yText = crdtProvider.getText(\"content\");\r\n    const currentContent = yText.toString();\r\n    \r\n    // Simple formatting operations\r\n    let formattedContent = currentContent;\r\n    switch (format) {\r\n      case \"uppercase\":\r\n        formattedContent = currentContent.toUpperCase();\r\n        break;\r\n      case \"lowercase\":\r\n        formattedContent = currentContent.toLowerCase();\r\n        break;\r\n      case \"clear\":\r\n        formattedContent = \"\";\r\n        break;\r\n    }\r\n    \r\n    yText.delete(0, yText.length);\r\n    yText.insert(0, formattedContent);\r\n    setContent(formattedContent);\r\n    updateStats(formattedContent);\r\n  };\r\n\r\n  const exportContent = () => {\r\n    const blob = new Blob([content], { type: 'text/plain' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'document.txt';\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  return (\r\n    <div className={`flex flex-col h-full ${isFullscreen ? 'fixed inset-0 z-50 bg-background' : ''}`}>\r\n      {/* Toolbar */}\r\n      {showToolbar && (\r\n        <div className=\"border-b bg-muted/30 px-4 py-2\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <select\r\n                value={fontSize}\r\n                onChange={(e) => setFontSize(e.target.value)}\r\n                className=\"px-2 py-1 text-xs border border-input rounded focus:outline-none focus:ring-1 focus:ring-ring\"\r\n              >\r\n                <option value=\"12\">12px</option>\r\n                <option value=\"14\">14px</option>\r\n                <option value=\"16\">16px</option>\r\n                <option value=\"18\">18px</option>\r\n                <option value=\"20\">20px</option>\r\n                <option value=\"24\">24px</option>\r\n              </select>\r\n              \r\n              <div className=\"flex items-center space-x-1\">\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleFormat(\"uppercase\")}\r\n                  title=\"Uppercase\"\r\n                >\r\n                  Aa\r\n                </Button>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleFormat(\"lowercase\")}\r\n                  title=\"Lowercase\"\r\n                >\r\n                  aa\r\n                </Button>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleFormat(\"clear\")}\r\n                  title=\"Clear\"\r\n                >\r\n                  Clear\r\n                </Button>\r\n              </div>\r\n              \r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={exportContent}\r\n                title=\"Export\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\r\n                </svg>\r\n              </Button>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center space-x-2\">\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => setShowToolbar(!showToolbar)}\r\n                title=\"Toggle Toolbar\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\r\n                </svg>\r\n              </Button>\r\n              <Button\r\n                variant=\"default\"\r\n                size=\"sm\"\r\n                onClick={onSave}\r\n                disabled={!onSave}\r\n                title=\"Save Document (Ctrl+S)\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V2\" />\r\n                </svg>\r\n                Save\r\n              </Button>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => setIsFullscreen(!isFullscreen)}\r\n                title=\"Toggle Fullscreen\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\" />\r\n                </svg>\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Stats Bar */}\r\n      <div className=\"border-b bg-muted/20 px-4 py-1\">\r\n        <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n          <div className=\"flex items-center space-x-4\">\r\n            <span>Words: {wordCount}</span>\r\n            <span>Characters: {charCount}</span>\r\n            <span>Reading time: {readingTime} min</span>\r\n          </div>\r\n          {lastSaved && (\r\n            <span>Last saved: {lastSaved.toLocaleTimeString()}</span>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Editor */}\r\n      <div className=\"flex-1 p-4\">\r\n        <textarea\r\n          value={content}\r\n          onChange={handleChange}\r\n          className=\"w-full h-full p-4 border border-input rounded-md bg-background text-foreground resize-none focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\"\r\n          style={{ fontSize: `${fontSize}px` }}\r\n          placeholder=\"Start writing your document...\"\r\n        />\r\n      </div>\r\n      <div className=\"border-t bg-muted/30 px-4 py-2 flex items-center justify-between text-xs text-muted-foreground\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          {isSaving ? (\r\n            <span className=\"flex items-center text-blue-600\">\r\n              <svg\r\n                className=\"w-3 h-3 mr-1 animate-spin\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n                />\r\n              </svg>\r\n              Saving...\r\n            </span>\r\n          ) : lastSaved ? (\r\n            <span className=\"flex items-center text-green-600\">\r\n              <svg\r\n                className=\"w-3 h-3 mr-1\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M5 13l4 4L19 7\"\r\n                />\r\n              </svg>\r\n              Saved {lastSaved.toLocaleTimeString()}\r\n            </span>\r\n          ) : (\r\n            <span>Ready to save</span>\r\n          )}\r\n        </div>\r\n        <div className=\"text-xs\">Auto-save enabled</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nfunction DrawingEditor({\r\n  crdtProvider,\r\n  canvasRef,\r\n  onSave,\r\n}: {\r\n  crdtProvider: CRDTProvider | null;\r\n  canvasRef: React.RefObject<HTMLCanvasElement>;\r\n  onSave?: () => Promise<void>;\r\n}) {\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\r\n  const [isDrawing, setIsDrawing] = useState(false);\r\n  const [currentTool, setCurrentTool] = useState<\"pen\" | \"eraser\" | \"rectangle\" | \"circle\">(\"pen\");\r\n  const [currentColor, setCurrentColor] = useState(\"#3b82f6\");\r\n  const [lineWidth, setLineWidth] = useState(2);\r\n  const [showToolbar, setShowToolbar] = useState(true);\r\n\r\n  const colors = [\r\n    \"#000000\", \"#ef4444\", \"#f59e0b\", \"#10b981\", \r\n    \"#3b82f6\", \"#8b5cf6\", \"#ec4899\", \"#6b7280\"\r\n  ];\r\n\r\n  useEffect(() => {\r\n    if (!crdtProvider || !canvasRef.current) return;\r\n\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (!ctx) return;\r\n\r\n    // Set canvas size\r\n    canvas.width = canvas.offsetWidth;\r\n    canvas.height = canvas.offsetHeight;\r\n\r\n    const yMap = crdtProvider.getMap(\"drawing\");\r\n    let lastX = 0;\r\n    let lastY = 0;\r\n    let startX = 0;\r\n    let startY = 0;\r\n\r\n    const handleAutoSave = async () => {\r\n      if (crdtProvider && !isSaving && onSave) {\r\n        setIsSaving(true);\r\n        try {\r\n          const content = await crdtProvider.syncWithDatabase();\r\n          console.log(\"Drawing auto-saved\");\r\n          setLastSaved(new Date());\r\n        } catch (error) {\r\n          console.error(\"Drawing auto-save failed:\", error);\r\n        } finally {\r\n          setIsSaving(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    const redrawCanvas = () => {\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n      const paths = yMap.get(\"paths\") || [];\r\n      \r\n      paths.forEach((path: any) => {\r\n        ctx.strokeStyle = path.color;\r\n        ctx.lineWidth = path.lineWidth;\r\n        ctx.lineCap = \"round\";\r\n        \r\n        if (path.type === \"line\") {\r\n          ctx.beginPath();\r\n          ctx.moveTo(path.from.x, path.from.y);\r\n          ctx.lineTo(path.to.x, path.to.y);\r\n          ctx.stroke();\r\n        } else if (path.type === \"rectangle\") {\r\n          ctx.beginPath();\r\n          ctx.rect(path.x, path.y, path.width, path.height);\r\n          ctx.stroke();\r\n        } else if (path.type === \"circle\") {\r\n          ctx.beginPath();\r\n          ctx.arc(path.x, path.y, path.radius, 0, 2 * Math.PI);\r\n          ctx.stroke();\r\n        }\r\n      });\r\n    };\r\n\r\n    const startDrawing = (e: MouseEvent) => {\r\n      const rect = canvas.getBoundingClientRect();\r\n      lastX = e.clientX - rect.left;\r\n      lastY = e.clientY - rect.top;\r\n      startX = lastX;\r\n      startY = lastY;\r\n      setIsDrawing(true);\r\n\r\n      if (currentTool === \"eraser\") {\r\n        ctx.globalCompositeOperation = \"destination-out\";\r\n        ctx.lineWidth = lineWidth * 3;\r\n      } else {\r\n        ctx.globalCompositeOperation = \"source-over\";\r\n        ctx.strokeStyle = currentColor;\r\n        ctx.lineWidth = lineWidth;\r\n      }\r\n    };\r\n\r\n    const draw = (e: MouseEvent) => {\r\n      if (!isDrawing) return;\r\n\r\n      const rect = canvas.getBoundingClientRect();\r\n      const x = e.clientX - rect.left;\r\n      const y = e.clientY - rect.top;\r\n\r\n      if (currentTool === \"pen\" || currentTool === \"eraser\") {\r\n        ctx.beginPath();\r\n        ctx.moveTo(lastX, lastY);\r\n        ctx.lineTo(x, y);\r\n        ctx.stroke();\r\n\r\n        // Store drawing data in CRDT\r\n        const paths = yMap.get(\"paths\") || [];\r\n        paths.push({\r\n          type: \"line\",\r\n          from: { x: lastX, y: lastY },\r\n          to: { x, y },\r\n          color: currentColor,\r\n          lineWidth,\r\n          tool: currentTool\r\n        });\r\n        yMap.set(\"paths\", paths);\r\n\r\n        lastX = x;\r\n        lastY = y;\r\n      } else if (currentTool === \"rectangle\" || currentTool === \"circle\") {\r\n        redrawCanvas();\r\n        ctx.strokeStyle = currentColor;\r\n        ctx.lineWidth = lineWidth;\r\n        \r\n        if (currentTool === \"rectangle\") {\r\n          ctx.beginPath();\r\n          ctx.rect(startX, startY, x - startX, y - startY);\r\n          ctx.stroke();\r\n        } else {\r\n          const radius = Math.sqrt(Math.pow(x - startX, 2) + Math.pow(y - startY, 2));\r\n          ctx.beginPath();\r\n          ctx.arc(startX, startY, radius, 0, 2 * Math.PI);\r\n          ctx.stroke();\r\n        }\r\n      }\r\n\r\n      // Trigger auto-save after drawing\r\n      setTimeout(handleAutoSave, 1000);\r\n    };\r\n\r\n    const stopDrawing = () => {\r\n      if (!isDrawing) return;\r\n      \r\n      if (currentTool === \"rectangle\" || currentTool === \"circle\") {\r\n        const rect = canvas.getBoundingClientRect();\r\n        const endX = event instanceof MouseEvent ? event.clientX - rect.left : startX;\r\n        const endY = event instanceof MouseEvent ? event.clientY - rect.top : startY;\r\n        \r\n        const paths = yMap.get(\"paths\") || [];\r\n        if (currentTool === \"rectangle\") {\r\n          paths.push({\r\n            type: \"rectangle\",\r\n            x: Math.min(startX, endX),\r\n            y: Math.min(startY, endY),\r\n            width: Math.abs(endX - startX),\r\n            height: Math.abs(endY - startY),\r\n            color: currentColor,\r\n            lineWidth\r\n          });\r\n        } else {\r\n          const radius = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));\r\n          paths.push({\r\n            type: \"circle\",\r\n            x: startX,\r\n            y: startY,\r\n            radius,\r\n            color: currentColor,\r\n            lineWidth\r\n          });\r\n        }\r\n        yMap.set(\"paths\", paths);\r\n      }\r\n      \r\n      setIsDrawing(false);\r\n      handleAutoSave();\r\n    };\r\n\r\n    // Load existing drawing\r\n    redrawCanvas();\r\n\r\n    canvas.addEventListener(\"mousedown\", startDrawing);\r\n    canvas.addEventListener(\"mousemove\", draw);\r\n    canvas.addEventListener(\"mouseup\", stopDrawing);\r\n    canvas.addEventListener(\"mouseout\", stopDrawing);\r\n\r\n    return () => {\r\n      canvas.removeEventListener(\"mousedown\", startDrawing);\r\n      canvas.removeEventListener(\"mousemove\", draw);\r\n      canvas.removeEventListener(\"mouseup\", stopDrawing);\r\n      canvas.removeEventListener(\"mouseout\", stopDrawing);\r\n    };\r\n  }, [crdtProvider, currentTool, currentColor, lineWidth, isSaving]);\r\n\r\n  const clearCanvas = () => {\r\n    if (!crdtProvider || !canvasRef.current) return;\r\n    \r\n    const yMap = crdtProvider.getMap(\"drawing\");\r\n    yMap.set(\"paths\", []);\r\n    \r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (ctx) {\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n  };\r\n\r\n  const exportCanvas = () => {\r\n    if (!canvasRef.current) return;\r\n    \r\n    const canvas = canvasRef.current;\r\n    const url = canvas.toDataURL('image/png');\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'drawing.png';\r\n    a.click();\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\">\r\n      {/* Drawing Toolbar */}\r\n      {showToolbar && (\r\n        <div className=\"border-b bg-muted/30 px-4 py-2\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              {/* Tool Selection */}\r\n              <div className=\"flex items-center space-x-1\">\r\n                <Button\r\n                  variant={currentTool === \"pen\" ? \"default\" : \"ghost\"}\r\n                  size=\"sm\"\r\n                  onClick={() => setCurrentTool(\"pen\")}\r\n                  title=\"Pen\"\r\n                >\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\r\n                  </svg>\r\n                </Button>\r\n                <Button\r\n                  variant={currentTool === \"eraser\" ? \"default\" : \"ghost\"}\r\n                  size=\"sm\"\r\n                  onClick={() => setCurrentTool(\"eraser\")}\r\n                  title=\"Eraser\"\r\n                >\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                  </svg>\r\n                </Button>\r\n                <Button\r\n                  variant={currentTool === \"rectangle\" ? \"default\" : \"ghost\"}\r\n                  size=\"sm\"\r\n                  onClick={() => setCurrentTool(\"rectangle\")}\r\n                  title=\"Rectangle\"\r\n                >\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <rect x=\"4\" y=\"6\" width=\"16\" height=\"12\" strokeWidth={2} />\r\n                  </svg>\r\n                </Button>\r\n                <Button\r\n                  variant={currentTool === \"circle\" ? \"default\" : \"ghost\"}\r\n                  size=\"sm\"\r\n                  onClick={() => setCurrentTool(\"circle\")}\r\n                  title=\"Circle\"\r\n                >\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <circle cx=\"12\" cy=\"12\" r=\"8\" strokeWidth={2} />\r\n                  </svg>\r\n                </Button>\r\n              </div>\r\n\r\n              {/* Color Picker */}\r\n              <div className=\"flex items-center space-x-1\">\r\n                {colors.map((color) => (\r\n                  <button\r\n                    key={color}\r\n                    onClick={() => setCurrentColor(color)}\r\n                    className={`w-6 h-6 rounded border-2 ${\r\n                      currentColor === color ? \"border-ring\" : \"border-border\"\r\n                    }`}\r\n                    style={{ backgroundColor: color }}\r\n                    title={color}\r\n                  />\r\n                ))}\r\n              </div>\r\n\r\n              {/* Line Width */}\r\n              <select\r\n                value={lineWidth}\r\n                onChange={(e) => setLineWidth(Number(e.target.value))}\r\n                className=\"px-2 py-1 text-xs border border-input rounded focus:outline-none focus:ring-1 focus:ring-ring\"\r\n              >\r\n                <option value=\"1\">Thin</option>\r\n                <option value=\"2\">Normal</option>\r\n                <option value=\"4\">Medium</option>\r\n                <option value=\"8\">Thick</option>\r\n              </select>\r\n\r\n              {/* Actions */}\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={clearCanvas}\r\n                title=\"Clear Canvas\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 13h6m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n                </svg>\r\n              </Button>\r\n              \r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={exportCanvas}\r\n                title=\"Export\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\r\n                </svg>\r\n              </Button>\r\n            </div>\r\n\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() => setShowToolbar(!showToolbar)}\r\n              title=\"Toggle Toolbar\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\r\n              </svg>\r\n            </Button>\r\n            <Button\r\n              variant=\"default\"\r\n              size=\"sm\"\r\n              onClick={onSave}\r\n              disabled={!onSave}\r\n              title=\"Save Document (Ctrl+S)\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V2\" />\r\n              </svg>\r\n              Save\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Canvas */}\r\n      <div className=\"flex-1 p-4\">\r\n        <canvas\r\n          ref={canvasRef}\r\n          className=\"w-full h-full border border-input rounded-md bg-white cursor-crosshair\"\r\n          style={{ touchAction: \"none\" }}\r\n        />\r\n      </div>\r\n      <div className=\"border-t bg-muted/30 px-4 py-2 flex items-center justify-between text-xs text-muted-foreground\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          {isSaving ? (\r\n            <span className=\"flex items-center text-blue-600\">\r\n              <svg\r\n                className=\"w-3 h-3 mr-1 animate-spin\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n                />\r\n              </svg>\r\n              Saving drawing...\r\n            </span>\r\n          ) : lastSaved ? (\r\n            <span className=\"flex items-center text-green-600\">\r\n              <svg\r\n                className=\"w-3 h-3 mr-1\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M5 13l4 4L19 7\"\r\n                />\r\n              </svg>\r\n              Saved {lastSaved.toLocaleTimeString()}\r\n            </span>\r\n          ) : (\r\n            <span>Ready to draw</span>\r\n          )}\r\n        </div>\r\n        <div className=\"text-xs\">Auto-save enabled</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nfunction PlanningEditor({\r\n  crdtProvider,\r\n  onSave,\r\n}: {\r\n  crdtProvider: CRDTProvider | null;\r\n  onSave?: () => Promise<void>;\r\n}) {\r\n  const [tasks, setTasks] = useState<any[]>([]);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\r\n  const [newTaskText, setNewTaskText] = useState(\"\");\r\n  const [filter, setFilter] = useState<\"all\" | \"active\" | \"completed\">(\"all\");\r\n  const [sortBy, setSortBy] = useState<\"date\" | \"priority\" | \"name\">(\"date\");\r\n\r\n  useEffect(() => {\r\n    if (!crdtProvider) return;\r\n\r\n    const yArray = crdtProvider.getArray(\"tasks\");\r\n    setTasks(yArray.toJSON());\r\n\r\n    const observer = () => {\r\n      setTasks(yArray.toJSON());\r\n      setTimeout(handleAutoSave, 1000);\r\n    };\r\n\r\n    yArray.observe(observer);\r\n    return () => yArray.unobserve(observer);\r\n  }, [crdtProvider]);\r\n\r\n  const handleAutoSave = async () => {\r\n    if (crdtProvider && !isSaving && onSave) {\r\n      setIsSaving(true);\r\n      try {\r\n        const content = await crdtProvider.syncWithDatabase();\r\n        console.log(\"Planning tasks auto-saved\");\r\n        setLastSaved(new Date());\r\n      } catch (error) {\r\n        console.error(\"Planning auto-save failed:\", error);\r\n      } finally {\r\n        setIsSaving(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const addTask = () => {\r\n    if (!crdtProvider || !newTaskText.trim()) return;\r\n    \r\n    const yArray = crdtProvider.getArray(\"tasks\");\r\n    yArray.push([{\r\n      id: Date.now(),\r\n      text: newTaskText.trim(),\r\n      completed: false,\r\n      priority: \"medium\",\r\n      createdAt: new Date().toISOString(),\r\n      dueDate: null,\r\n      tags: []\r\n    }]);\r\n    setNewTaskText(\"\");\r\n  };\r\n\r\n  const updateTask = (index: number, updates: Partial<any>) => {\r\n    if (!crdtProvider) return;\r\n    \r\n    const yArray = crdtProvider.getArray(\"tasks\");\r\n    const task = yArray.get(index);\r\n    yArray.delete(index);\r\n    yArray.insert(index, [{ ...task, ...updates }]);\r\n  };\r\n\r\n  const deleteTask = (index: number) => {\r\n    if (!crdtProvider) return;\r\n    \r\n    const yArray = crdtProvider.getArray(\"tasks\");\r\n    yArray.delete(index);\r\n  };\r\n\r\n  const toggleTask = (index: number) => {\r\n    const task = tasks[index];\r\n    updateTask(index, { completed: !task.completed });\r\n  };\r\n\r\n  const filteredTasks = tasks.filter(task => {\r\n    if (filter === \"active\") return !task.completed;\r\n    if (filter === \"completed\") return task.completed;\r\n    return true;\r\n  });\r\n\r\n  const sortedTasks = [...filteredTasks].sort((a, b) => {\r\n    if (sortBy === \"date\") return new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime();\r\n    if (sortBy === \"priority\") {\r\n      const priorityOrder = { high: 3, medium: 2, low: 1 };\r\n      return priorityOrder[b.priority] - priorityOrder[a.priority];\r\n    }\r\n    if (sortBy === \"name\") return a.text.localeCompare(b.text);\r\n    return 0;\r\n  });\r\n\r\n  const taskStats = {\r\n    total: tasks.length,\r\n    completed: tasks.filter(t => t.completed).length,\r\n    active: tasks.filter(t => !t.completed).length\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\">\r\n      <div className=\"flex-1 p-4\">\r\n        {/* Stats Bar */}\r\n        <div className=\"mb-4 p-3 bg-muted/50 rounded-lg\">\r\n          <div className=\"flex items-center justify-between text-sm\">\r\n            <div className=\"flex space-x-4\">\r\n              <span className=\"font-medium\">Total: {taskStats.total}</span>\r\n              <span className=\"text-blue-600\">Active: {taskStats.active}</span>\r\n              <span className=\"text-green-600\">Completed: {taskStats.completed}</span>\r\n            </div>\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              {taskStats.total > 0 ? Math.round((taskStats.completed / taskStats.total) * 100) : 0}% complete\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Controls */}\r\n        <div className=\"mb-4 flex flex-wrap gap-2\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <input\r\n              type=\"text\"\r\n              value={newTaskText}\r\n              onChange={(e) => setNewTaskText(e.target.value)}\r\n              onKeyPress={(e) => e.key === \"Enter\" && addTask()}\r\n              placeholder=\"Add a new task...\"\r\n              className=\"px-3 py-2 border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring\"\r\n            />\r\n            <Button onClick={addTask} size=\"sm\" disabled={!newTaskText.trim()}>\r\n              Add Task\r\n            </Button>\r\n            <Button\r\n              variant=\"default\"\r\n              size=\"sm\"\r\n              onClick={onSave}\r\n              disabled={!onSave}\r\n              title=\"Save Document (Ctrl+S)\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V2\" />\r\n              </svg>\r\n              Save\r\n            </Button>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center space-x-2\">\r\n            <select\r\n              value={filter}\r\n              onChange={(e) => setFilter(e.target.value as any)}\r\n              className=\"px-3 py-2 border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring\"\r\n            >\r\n              <option value=\"all\">All Tasks</option>\r\n              <option value=\"active\">Active</option>\r\n              <option value=\"completed\">Completed</option>\r\n            </select>\r\n            \r\n            <select\r\n              value={sortBy}\r\n              onChange={(e) => setSortBy(e.target.value as any)}\r\n              className=\"px-3 py-2 border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring\"\r\n            >\r\n              <option value=\"date\">Sort by Date</option>\r\n              <option value=\"priority\">Sort by Priority</option>\r\n              <option value=\"name\">Sort by Name</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Task List */}\r\n        <div className=\"space-y-2\">\r\n          {sortedTasks.length === 0 ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              {filter === \"completed\" ? \"No completed tasks yet\" : \r\n               filter === \"active\" ? \"No active tasks\" : \r\n               \"No tasks yet. Add one above!\"}\r\n            </div>\r\n          ) : (\r\n            sortedTasks.map((task, index) => {\r\n              const originalIndex = tasks.findIndex(t => t.id === task.id);\r\n              return (\r\n                <div\r\n                  key={task.id}\r\n                  className={`flex items-center space-x-3 p-3 border border-input rounded-md transition-colors ${\r\n                    task.completed ? \"bg-muted/30\" : \"bg-background\"\r\n                  }`}\r\n                >\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={task.completed}\r\n                    onChange={() => toggleTask(originalIndex)}\r\n                    className=\"w-4 h-4\"\r\n                  />\r\n                  \r\n                  <div className=\"flex-1\">\r\n                    <div className={`flex items-center space-x-2 ${\r\n                      task.completed ? \"line-through text-muted-foreground\" : \"\"\r\n                    }`}>\r\n                      <span className=\"font-medium\">{task.text}</span>\r\n                      \r\n                      {/* Priority Badge */}\r\n                      <span className={`px-2 py-1 text-xs rounded-full ${\r\n                        task.priority === \"high\" ? \"bg-red-100 text-red-700\" :\r\n                        task.priority === \"medium\" ? \"bg-yellow-100 text-yellow-700\" :\r\n                        \"bg-green-100 text-green-700\"\r\n                      }`}>\r\n                        {task.priority}\r\n                      </span>\r\n                    </div>\r\n                    \r\n                    {/* Task Meta */}\r\n                    <div className=\"flex items-center space-x-2 mt-1 text-xs text-muted-foreground\">\r\n                      <span>Created {new Date(task.createdAt).toLocaleDateString()}</span>\r\n                      {task.dueDate && (\r\n                        <span>‚Ä¢ Due {new Date(task.dueDate).toLocaleDateString()}</span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Actions */}\r\n                  <div className=\"flex items-center space-x-1\">\r\n                    <select\r\n                      value={task.priority}\r\n                      onChange={(e) => updateTask(originalIndex, { priority: e.target.value })}\r\n                      className=\"px-2 py-1 text-xs border border-input rounded focus:outline-none focus:ring-1 focus:ring-ring\"\r\n                    >\r\n                      <option value=\"low\">Low</option>\r\n                      <option value=\"medium\">Medium</option>\r\n                      <option value=\"high\">High</option>\r\n                    </select>\r\n                    \r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => deleteTask(originalIndex)}\r\n                      className=\"text-red-600 hover:text-red-700 hover:bg-red-50\"\r\n                    >\r\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                      </svg>\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"border-t bg-muted/30 px-4 py-2 flex items-center justify-between text-xs text-muted-foreground\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          {isSaving ? (\r\n            <span className=\"flex items-center text-blue-600\">\r\n              <svg\r\n                className=\"w-3 h-3 mr-1 animate-spin\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n                />\r\n              </svg>\r\n              Saving tasks...\r\n            </span>\r\n          ) : lastSaved ? (\r\n            <span className=\"flex items-center text-green-600\">\r\n              <svg\r\n                className=\"w-3 h-3 mr-1\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M5 13l4 4L19 7\"\r\n                />\r\n              </svg>\r\n              Saved {lastSaved.toLocaleTimeString()}\r\n            </span>\r\n          ) : (\r\n            <span>Ready to plan</span>\r\n          )}\r\n        </div>\r\n        <div className=\"text-xs\">Auto-save enabled</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4730, "column": 0}, "map": {"version":3,"sources":["file:///E:/wark/Next.graphQL/nextTyar/src/app/dashboard/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { DocumentList } from \"@/components/DocumentList\";\r\nimport { DocumentEditor } from \"@/components/DocumentEditor\";\r\nimport { ApolloClient, InMemoryCache, HttpLink } from \"@apollo/client\";\r\nimport { ApolloProvider } from \"@apollo/client/react\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/Card\";\r\n\r\nconst client = new ApolloClient({\r\n  link: new HttpLink({\r\n    uri: \"/api/graphql\",\r\n  }),\r\n  cache: new InMemoryCache(),\r\n});\r\n\r\nexport default function Dashboard() {\r\n  const { data: session, status } = useSession();\r\n  const router = useRouter();\r\n  const [selectedDocument, setSelectedDocument] = useState<{\r\n    id: string;\r\n    type: \"planning\" | \"drawing\" | \"writing\";\r\n  } | null>(null);\r\n\r\n  // Redirect to sign-in if not authenticated\r\n  useEffect(() => {\r\n    if (status === \"loading\") return;\r\n    if (!session) {\r\n      router.push(\"/auth/signin\");\r\n    }\r\n  }, [session, status, router]);\r\n\r\n  if (status === \"loading\") {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-muted-foreground\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!session) {\r\n    return null; // Will redirect via useEffect\r\n  }\r\n\r\n  const handleDocumentSelect = (\r\n    documentId: string,\r\n    documentType: \"planning\" | \"drawing\" | \"writing\"\r\n  ) => {\r\n    setSelectedDocument({ id: documentId, type: documentType });\r\n  };\r\n\r\n  const handleBackToList = () => {\r\n    setSelectedDocument(null);\r\n  };\r\n\r\n  return (\r\n    <ApolloProvider client={client}>\r\n      <div className=\"min-h-screen bg-background\">\r\n        <header className=\"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\r\n          <div className=\"container flex h-16 items-center\">\r\n            <div className=\"flex items-center space-x-4\">\r\n              {selectedDocument && (\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={handleBackToList}>\r\n                  ‚Üê Back\r\n                </Button>\r\n              )}\r\n              <h1 className=\"text-xl font-semibold\">Collaborative Workspace</h1>\r\n            </div>\r\n            <div className=\"ml-auto flex items-center space-x-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <div className=\"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                  <span className=\"text-sm font-medium text-primary\">\r\n                    {session.user?.name?.[0] || session.user?.email?.[0] || \"U\"}\r\n                  </span>\r\n                </div>\r\n                <span className=\"text-sm text-muted-foreground hidden sm:block\">\r\n                  {session.user?.name || session.user?.email}\r\n                </span>\r\n              </div>\r\n              <Button variant=\"ghost\" size=\"sm\" asChild>\r\n                <a href=\"/api/auth/signout\">Sign out</a>\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </header>\r\n\r\n        <div className=\"flex h-[calc(100vh-4rem)]\">\r\n          {selectedDocument ? (\r\n            <div className=\"flex-1\">\r\n              <DocumentEditor\r\n                documentId={selectedDocument.id}\r\n                documentType={selectedDocument.type}\r\n              />\r\n            </div>\r\n          ) : (\r\n            <div className=\"flex flex-1\">\r\n              <div className=\"w-80 border-r bg-muted/0\">\r\n                <DocumentList onDocumentSelect={handleDocumentSelect} />\r\n              </div>\r\n              <div className=\"flex-1 flex items-center justify-center p-8\">\r\n                <Card className=\"w-full max-w-md text-center\">\r\n                  <CardHeader>\r\n                    <div className=\"mx-auto w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-4\">\r\n                      <svg\r\n                        className=\"w-8 h-8 text-primary\"\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        viewBox=\"0 0 24 24\"\r\n                      >\r\n                        <path\r\n                          strokeLinecap=\"round\"\r\n                          strokeLinejoin=\"round\"\r\n                          strokeWidth={2}\r\n                          d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n                        />\r\n                      </svg>\r\n                    </div>\r\n                    <CardTitle>Welcome to your workspace</CardTitle>\r\n                    <CardDescription>\r\n                      Select a document from the sidebar to start collaborating\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-2 text-sm text-muted-foreground\">\r\n                      <p>üìù Create and edit documents together</p>\r\n                      <p>üé® Draw and sketch in real-time</p>\r\n                      <p>üìã Plan and organize collaboratively</p>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </ApolloProvider>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}